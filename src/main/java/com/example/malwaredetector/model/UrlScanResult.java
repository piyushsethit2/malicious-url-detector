package com.example.malwaredetector.model;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.time.LocalDateTime;
import java.util.List;
import java.util.Map;

public class UrlScanResult {
    private String url;
    private boolean isMalicious;
    private String overallStatus;
    private LocalDateTime scannedAt;
    private Map<String, DetectionResult> detectionResults;
    private List<String> threats;
    private double confidenceScore;
    private String recommendation;

    public static class DetectionResult {
        private String method;
        private boolean detected;
        private String details;
        private double confidence;
        private String status;

        public DetectionResult(String method, boolean detected, String details, double confidence) {
            this.method = method;
            this.detected = detected;
            this.details = details;
            this.confidence = confidence;
            this.status = detected ? "MALICIOUS" : "CLEAN";
        }

        // Getters and setters
        public String getMethod() { return method; }
        public void setMethod(String method) { this.method = method; }
        
        @JsonProperty("detected")
        public boolean isDetected() { return detected; }
        public void setDetected(boolean detected) { this.detected = detected; }
        
        public String getDetails() { return details; }
        public void setDetails(String details) { this.details = details; }
        
        public double getConfidence() { return confidence; }
        public void setConfidence(double confidence) { this.confidence = confidence; }
        
        public String getStatus() { return status; }
        public void setStatus(String status) { this.status = status; }
    }

    // Getters and setters
    public String getUrl() { return url; }
    public void setUrl(String url) { this.url = url; }
    public boolean isMalicious() { return isMalicious; }
    public void setMalicious(boolean malicious) { isMalicious = malicious; }
    public String getOverallStatus() { return overallStatus; }
    public void setOverallStatus(String overallStatus) { this.overallStatus = overallStatus; }
    public LocalDateTime getScannedAt() { return scannedAt; }
    public void setScannedAt(LocalDateTime scannedAt) { this.scannedAt = scannedAt; }
    public Map<String, DetectionResult> getDetectionResults() { return detectionResults; }
    public void setDetectionResults(Map<String, DetectionResult> detectionResults) { this.detectionResults = detectionResults; }
    public List<String> getThreats() { return threats; }
    public void setThreats(List<String> threats) { this.threats = threats; }
    public double getConfidenceScore() { return confidenceScore; }
    public void setConfidenceScore(double confidenceScore) { this.confidenceScore = confidenceScore; }
    public String getRecommendation() { return recommendation; }
    public void setRecommendation(String recommendation) { this.recommendation = recommendation; }
} 